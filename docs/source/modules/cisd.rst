.. _cisd:

.. program:: cisd

.. default-role:: option

====
cisd
====

This module contains a CISD program, built by setting the following rules:

* The only generator determinant is the Hartree-Fock (single-reference method)
* All generated determinants are included in the wave function (no perturbative
  selection)

These rules are set in the ``H_apply.irp.f`` file.





EZFIO parameters
----------------

.. option:: energy

    Variational |CISD| energy



Subroutines / functions
-----------------------



.. c:function:: cisd

    .. code:: text

        subroutine cisd

    File: :file:`cisd.irp.f`

    Configuration Interaction with Single and Double excitations. 

    This program takes a reference Slater determinant of ROHF-like occupancy, 

    and performs all single and double excitations on top of it, disregarding spatial symmetry and compute the "n_states" lowest eigenstates of that CI matrix. 

    This program can be useful in many cases: 

    * GROUND STATE CALCULATION: if even after a cis calculation, natural orbitals and then scf optimization, you are not sure to have the lowest scf solution, do the same strategy with the cisd executable to generate the natural orbitals as a guess for the scf. 

    

    

    * EXCITED STATES CALCULATIONS: the lowest excited states are much likely to be dominanted by single- or double-excitations. 

    Therefore, running a cis will save the "n_states" lowest states within the CISD space 

    in the EZFIO folder, which can afterward be used as guess wave functions for a further 

    multi-state fci calculation if you specify "read_wf" = True before running the fci executable. 

    Also, if you specify "s2_eig" = True, the cisd will only retain states having the good value :math:`S^2` value (see expected_s2). 

    If "s2_eig" = False, it will take the lowest n_states, whatever multiplicity they are. 

    

    

    Note: if you would like to discard some orbitals, use qp_set_mo_class to specify: 

    * "core" orbitals which will be always doubly occupied 

    * "act" orbitals where an electron can be either excited from or to 

    * "del" orbitals which will be never occupied





.. c:function:: h_apply_cisd

    .. code:: text

        subroutine H_apply_cisd()

    File: :file:`h_apply.irp.f_shell_8`

    Calls H_apply on the |HF| determinant and selects all connected single and double excitations (of the same symmetry). Auto-generated by the ``generate_h_apply`` script.





.. c:function:: h_apply_cisd_diexc

    .. code:: text

        subroutine H_apply_cisd_diexc(key_in, key_prev, hole_1,particl_1, hole_2, particl_2, fock_diag_tmp, i_generator, iproc_in  )

    File: :file:`h_apply.irp.f_shell_8`

    





.. c:function:: h_apply_cisd_diexcorg

    .. code:: text

        subroutine H_apply_cisd_diexcOrg(key_in,key_mask,hole_1,particl_1,hole_2, particl_2, fock_diag_tmp, i_generator, iproc_in  )

    File: :file:`h_apply.irp.f_shell_8`

    Generate all double excitations of key_in using the bit masks of holes and particles. Assume N_int is already provided.





.. c:function:: h_apply_cisd_diexcp

    .. code:: text

        subroutine H_apply_cisd_diexcP(key_in, fs1, fh1, particl_1, fs2, fh2, particl_2, fock_diag_tmp, i_generator, iproc_in  )

    File: :file:`h_apply.irp.f_shell_8`

    





.. c:function:: h_apply_cisd_monoexc

    .. code:: text

        subroutine H_apply_cisd_monoexc(key_in, hole_1,particl_1,fock_diag_tmp,i_generator,iproc_in  )

    File: :file:`h_apply.irp.f_shell_8`

    Generate all single excitations of key_in using the bit masks of holes and particles. Assume N_int is already provided.


